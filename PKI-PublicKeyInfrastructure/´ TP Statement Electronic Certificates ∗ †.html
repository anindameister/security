
<!-- saved from url=(0051)https://translate.googleusercontent.com/translate_f -->
<html lang="en" class="translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="google" content="notranslate">
<script>(function(){/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
(function(){function e(g){this.t={};this.tick=function(h,k,f){this.t[h]=[void 0!=f?f:(new Date).getTime(),k];if(void 0==f)try{window.console.timeStamp("CSI/"+h)}catch(m){}};this.getStartTickTime=function(){return this.t.start[0]};this.tick("start",null,g)}var a;if(window.performance)var d=(a=window.performance.timing)&&a.responseStart;var l=0<d?new e(d):new e;window.jstiming={Timer:e,load:l};if(a){var b=a.navigationStart;0<b&&d>=b&&(window.jstiming.srt=d-b)}if(a){var c=window.jstiming.load;0<b&&d>=
b&&(c.tick("_wtsrt",void 0,b),c.tick("wtsrt_","_wtsrt",d),c.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),c&&0<b&&(c.tick("_tbnd",void 0,window.chrome.csi().startE),c.tick("tbnd_","_tbnd",b))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,c&&0<b&&(c.tick("_tbnd",void 0,window.external.startE),c.tick("tbnd_","_tbnd",b))),a&&(window.jstiming.pt=a)}catch(g){}})();}).call(window);
</script><script src="./´ TP Statement Electronic Certificates ∗ †_files/translate_c.js.download"></script><script>_intlStrings._originalText = "Original French text:";_intlStrings._interfaceDirection="ltr";_intlStrings._interfaceAlign="left";_intlStrings._langpair="fr|en";_intlStrings._feedbackUrl="https://translate.google.com/translate_suggestion";_intlStrings._currentBy="Current translation on %1$s by %2$s";_intlStrings._unknown="unknown";_intlStrings._suggestTranslation="Contribute a better translation"  ;_intlStrings._submit="Contribute";_intlStrings._suggestThanks="Thank you for contributing your translation suggestion to Google Translate.";_intlStrings._reverse=false;_intlStrings._staticContentPath="https://www.gstatic.com/translate/infowindow/";</script><style type="text/css">.google-src-text {display: none !important} .google-src-active-text {display: block!important;color:black!important; font-size:12px!important;font-family:arial,sans-serif!important}.google-src-active-text a {font-size:12px!important}.google-src-active-text a:link {color:#00c!important;text-decoration:underline!important}.google-src-active-text a:visited {color:purple!important;text-decoration:underline!important}.google-src-active-text a:active {color:red!important;text-decoration:underline!important}</style><meta http-equiv="X-Translated-By" content="Google"><link href="https://translate.googleusercontent.com/certificate-exportVM.pdf" hreflang="fr" rel="alternate machine-translated-from"><link href="./´ TP Statement Electronic Certificates ∗ †_files/css" rel="stylesheet" type="text/css"><!--<base href="" target="_top">--><base href="." target="_top">

<meta name="Producer" content="pdfTeX-1.40.19">
<meta name="Creator" content="TeX">
<meta name="CreationDate" content="D:20200325100613Z">
<meta name="ModDate" content="D:20200325100613Z">
<meta name="Fullbanner" content="This is pdfTeX, Version 3.14159265-2.6-1.40.19 (TeX Live 2018) kpathsea version 6.3.0">
<title>´ TP Statement Electronic Certificates ∗ †</title>
<link type="text/css" rel="stylesheet" charset="UTF-8" href="./´ TP Statement Electronic Certificates ∗ †_files/translateelement.css"><script type="text/javascript" charset="UTF-8" src="./´ TP Statement Electronic Certificates ∗ †_files/main.js.download"></script><script type="text/javascript" charset="UTF-8" src="./´ TP Statement Electronic Certificates ∗ †_files/element_main.js.download"></script><link rel="stylesheet" type="text/css" href="./´ TP Statement Electronic Certificates ∗ †_files/iw_sprite.css"></head><body bgcolor="#ffffff" vlink="blue" link="blue">
        <style>
          .spinner-container {
            width:25%;
            top:20px;
            left:50%;
            margin-left:-12.5%;
            border-radius:8px;
            position:fixed;
            text-align:center;
            box-shadow:0 0 10px rgba(0,0,0,0.24);
            background:#fff;
            overflow:hidden;
          }

          .spinner-container p{
            font-family:'Roboto', Arial, sans-serif;
            color:rgba(0,0,0,0.87);
            margin:12px 0 16px 0;
            padding:0;
            font-size:12px;
          }

          .spinner-container img{
            width:22px;
            height:22px;
            margin:16px 0 0;
            padding:0;
          }
        </style>
        <div class="spinner-container notranslate" id="gt-dt-spinner" style="display: none;">
         <img src="./´ TP Statement Electronic Certificates ∗ †_files/progress_spinner_color_20dp@2x.gif">
         <p>Translating...</p>
        </div>
      <iframe src="./´ TP Statement Electronic Certificates ∗ †_files/translate_un.html" width="0" height="0" frameborder="0" style="width:0px;height:0px;border:0px;display:none;"></iframe>
<table border="0" width="100%"><tbody><tr><td bgcolor="eeeeee" align="right"><font face="arial,sans-serif"><a name="1"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page 1</font></font></b></a></font></td></tr></tbody></table><font size="4" face="Times"><span style="font-size:23px;font-family:Times">
<div style="position:absolute;top:356;left:236"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">´ TP Statement Electronic Certificates </font></font><font style="font-size:15px"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗ †</font></font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:411;left:234"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isabelle Chrisment, Philippe Jaillon, Maryline Laurent,</font></font></nobr></div>
<div style="position:absolute;top:432;left:313"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Marwan Lazragi, Souha Masmoudi</font></font></nobr></div>
<div style="position:absolute;top:467;left:398"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">January 2020</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:551;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:589;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A company X has several different geographical locations which are for example</font></font></nobr></div>
<div style="position:absolute;top:607;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paris, Brest and Marseille. </font><font style="vertical-align: inherit;">These different sites are connected to the Internet, which allows</font></font></nobr></div>
<div style="position:absolute;top:625;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">staff to easily exchange information. </font><font style="vertical-align: inherit;">However, all exchanges that have a</font></font></nobr></div>
<div style="position:absolute;top:642;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">official character do not pass through this network and are made in paper form using the</font></font></nobr></div>
<div style="position:absolute;top:660;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mail laugh. </font><font style="vertical-align: inherit;">The company finds that this is the only way secure enough to broadcast</font></font></nobr></div>
<div style="position:absolute;top:678;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">confidential data. </font><font style="vertical-align: inherit;">On the other hand, she finds that this method is not sufficient</font></font></nobr></div>
<div style="position:absolute;top:696;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">efficient and too expensive.</font></font></nobr></div>
<div style="position:absolute;top:714;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">New company information manager proposes to use World Wide Web</font></font></nobr></div>
<div style="position:absolute;top:732;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to solve these cost and efficiency problems. </font><font style="vertical-align: inherit;">To the remarks that his management makes to him</font></font></nobr></div>
<div style="position:absolute;top:750;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">concerning the confidentiality of exchanges and the authentication of personnel, he suggests using</font></font></nobr></div>
<div style="position:absolute;top:768;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">electronic certificates which, according to him, are a flexible and robust solution when they are</font></font></nobr></div>
<div style="position:absolute;top:786;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">properly implemented.</font></font></nobr></div>
<div style="position:absolute;top:804;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We will see in this lab how to create electronic certificates, how to use them</font></font></nobr></div>
<div style="position:absolute;top:822;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and discover all the interest.</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:867;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Environment</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:904;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To realistically simulate our working environment, you have in the labtai-</font></font></nobr></div>
<div style="position:absolute;top:923;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ner certificate of 4 machines connected to each other. </font><font style="vertical-align: inherit;">The www machine will host the web server</font></font></nobr></div>
<div style="position:absolute;top:940;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of the company, the CA machine will be dedicated to the certification authority (all</font></font></nobr></div>
<div style="position:absolute;top:958;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">creation and signing of certificates will be carried out there). </font><font style="vertical-align: inherit;">The brest and marseille machines are</font></font></nobr></div>
<div style="position:absolute;top:976;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will be machines used by goodguy and badboy users respectively. </font><font style="vertical-align: inherit;">Machines</font></font></nobr></div>
<div style="position:absolute;top:994;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">are configured to use the services of a DNS and can therefore be contacted directly</font></font></nobr></div>
<div style="position:absolute;top:1012;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">by name.</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:1056;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Starting the lab</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:1094;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After starting your Labtainers virtual machine, from the current directory</font></font></nobr></div>
<div style="position:absolute;top:1112;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(~ / labtainer / labtainer-student), run the following command:</font></font></nobr></div>
<div style="position:absolute;top:1143;left:356"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ labtainer certificate</font></font></nobr></div>
</span></font>
<font size="2" face="Times"><span style="font-size:6px;font-family:Times">
<div style="position:absolute;top:1164;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">∗ </font></font><font style="font-size:9px"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carried out as part of the network security MOOC funded by the ANR FLIRT project and the foundation</font></font></font></nobr></div>
</span></font>
<font size="2" face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:1181;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DRAHI.</font></font></nobr></div>
</span></font>
<font size="2" face="Times"><span style="font-size:6px;font-family:Times">
<div style="position:absolute;top:1193;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">† </font></font><font style="font-size:9px"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This lab named Certificates is licensed by Isabelle Chrisment, Philippe Jaillon, Maryline Laurent, Mar-</font></font></font></nobr></div>
</span></font>
<font size="2" face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:1210;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wan Lazragi, Souha Masmoudi under the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0</font></font></nobr></div>
<div style="position:absolute;top:1224;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">International License. </font><font style="vertical-align: inherit;">To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-nd/4.0/ or</font></font></nobr></div>
<div style="position:absolute;top:1238;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">send a letter to Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:1345;left:443"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></nobr></div>
</span></font>

<div style="position:absolute;top:1437;left:0"><hr><table border="0" width="100%"><tbody><tr><td bgcolor="eeeeee" align="right"><font face="arial,sans-serif"><a name="2"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page 2</font></font></b></a></font></td></tr></tbody></table></div><font size="3" face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:1565;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 Creation of the certificate of the certification authority</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:1602;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Before creating the certificates, company X must first choose an authority to</font></font></nobr></div>
<div style="position:absolute;top:1620;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certification which will subsequently issue it with the various certificates it will need. </font><font style="vertical-align: inherit;">For some</font></font></nobr></div>
<div style="position:absolute;top:1638;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reasons of its own, it has decided to create and manage its own certification authority.</font></font></nobr></div>
<div style="position:absolute;top:1656;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A certification authority (CA) must have a particular certificate called a</font></font></nobr></div>
<div style="position:absolute;top:1674;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">root certificate. </font><font style="vertical-align: inherit;">This certificate has the particularity of being signed by its own private key, thus</font></font></nobr></div>
<div style="position:absolute;top:1692;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this way, everyone can check that it has been signed by the owner of the private key</font></font></nobr></div>
<div style="position:absolute;top:1709;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">associated with the public key available in the certificate.</font></font></nobr></div>
<div style="position:absolute;top:1727;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If the public key can be widely distributed, the private key is on the contrary confidential and</font></font></nobr></div>
<div style="position:absolute;top:1745;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">must be very well protected: this is the element on which all the security of the system is based.</font></font></nobr></div>
<div style="position:absolute;top:1763;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If a third party becomes aware of the private key of the CA, he can then generate real fake</font></font></nobr></div>
<div style="position:absolute;top:1781;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certificates (certificates recognized as valid by all people trusting this CA,</font></font></nobr></div>
<div style="position:absolute;top:1799;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">but that she will not have signed herself).</font></font></nobr></div>
<div style="position:absolute;top:1817;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Our first task will therefore consist in generating the key pair (public / private) of the au-</font></font></nobr></div>
<div style="position:absolute;top:1835;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certification body. </font><font style="vertical-align: inherit;">To do this, select the console of the CA machine, verify that you</font></font></nobr></div>
<div style="position:absolute;top:1853;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">you are in the home directory of the authority user (/ home / authority).</font></font></nobr></div>
<div style="position:absolute;top:1887;left:239"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl genrsa -des3 -out private / ca.key.pem 2048</font></font></nobr></div>
<div style="position:absolute;top:1917;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• The -des3 option means that the key pair is protected by an encryption using the al-</font></font></nobr></div>
<div style="position:absolute;top:1936;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gorithm DES3. </font><font style="vertical-align: inherit;">To learn about the key, it is necessary to know the</font></font></nobr></div>
<div style="position:absolute;top:1958;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Passphrase" (long password which can even contain spaces) which protects it.</font></font></nobr></div>
<div style="position:absolute;top:1982;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• The -out option specifies the name of the file that contains the key pair.</font></font></nobr></div>
<div style="position:absolute;top:2012;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• The last parameter is the size of the key in bits (2048 bits in our example).</font></font></nobr></div>
<div style="position:absolute;top:2045;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can display the different elements of the generated key by typing the following command:</font></font></nobr></div>
<div style="position:absolute;top:2079;left:274"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl rsa -in private / ca.key.pem -text</font></font></nobr></div>
<div style="position:absolute;top:2128;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q1: Is it possible to access this key? </font><font style="vertical-align: inherit;">Explain.</font></font></nobr></div>
<div style="position:absolute;top:2158;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yes indeed</font></font></nobr></div>
<div style="position:absolute;top:2187;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) No</font></font></nobr></div>
<div style="position:absolute;top:2217;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now that we have a couple of keys, we will generate the certificate of our</font></font></nobr></div>
<div style="position:absolute;top:2235;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certification authority. </font><font style="vertical-align: inherit;">This will be a self-signed X.509 certificate (a certification root).</font></font></nobr></div>
<div style="position:absolute;top:2253;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To do this, we will sign the information concerning this associated certification authority.</font></font></nobr></div>
<div style="position:absolute;top:2271;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ciée to its public key using the private key. </font><font style="vertical-align: inherit;">This certificate will be valid for 5 years</font></font></nobr></div>
<div style="position:absolute;top:2289;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1825 days).</font></font></nobr></div>
<div style="position:absolute;top:2322;left:223"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl req -config openssl.cnf -new -x509 -days 1825</font></font></nobr></div>
<div style="position:absolute;top:2340;left:223"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-extensions v3_ca -key private / ca.key.pem -out ca.crt.pem</font></font></nobr></div>
<div style="position:absolute;top:2371;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• the -config option is used to designate the configuration file to use (for the lab we</font></font></nobr></div>
<div style="position:absolute;top:2389;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">let us provide you with a configuration file adapted to our environment:</font></font></nobr></div>
<div style="position:absolute;top:2407;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">openssl.cnf).</font></font></nobr></div>
<div style="position:absolute;top:2436;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• The -new parameter combined with x509 indicates that you want a self-signed X.509 certificate.</font></font></nobr></div>
<div style="position:absolute;top:2466;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• The -days parameter indicates the validity period of the certificate (in days).</font></font></nobr></div>
<div style="position:absolute;top:2496;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• The -key parameter specifies the RSA key to use.</font></font></nobr></div>
<div style="position:absolute;top:2525;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• The -extensions parameter indicates which section of the configuration file specifies the</font></font></nobr></div>
<div style="position:absolute;top:2544;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X509 extensions that must be added to the certificate (the main one being that this certificate</font></font></nobr></div>
<div style="position:absolute;top:2562;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is that of a certification authority).</font></font></nobr></div>
<div style="position:absolute;top:2607;left:443"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></nobr></div>
</span></font>

<div style="position:absolute;top:2699;left:0"><hr><table border="0" width="100%"><tbody><tr><td bgcolor="eeeeee" align="right"><font face="arial,sans-serif"><a name="3"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page 3</font></font></b></a></font></td></tr></tbody></table></div><font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:2830;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• The -out parameter defines the name of the file containing the certificate that will be generated.</font></font></nobr></div>
<div style="position:absolute;top:2882;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q2: Why do I have to enter a passphrase when executing this command?</font></font></nobr></div>
<div style="position:absolute;top:2912;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a) To prove that the private key used belongs to us.</font></font></nobr></div>
<div style="position:absolute;top:2942;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) To protect the generated certificate.</font></font></nobr></div>
<div style="position:absolute;top:2972;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">During the execution of the command, we are asked about the values ​​that must</font></font></nobr></div>
<div style="position:absolute;top:2990;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">take the different fields of what is called the distinguished name (or DN): the name that will be</font></font></nobr></div>
<div style="position:absolute;top:3007;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">associated with the certificate. </font><font style="vertical-align: inherit;">This information must be entered with care. </font><font style="vertical-align: inherit;">Once the certificate</font></font></nobr></div>
<div style="position:absolute;top:3025;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of our certification authority will be signed, it will no longer be possible to modify them and all</font></font></nobr></div>
<div style="position:absolute;top:3043;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certificates issued by this CA will refer to it.</font></font></nobr></div>
<div style="position:absolute;top:3087;left:169"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Country Name (2 letter code) [FR]:</font></font></nobr></div>
<div style="position:absolute;top:3105;left:169"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sate or Province Name (full name) [FRANCE]:</font></font></nobr></div>
<div style="position:absolute;top:3123;left:169"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organization Name (eg, company) [AA MOOC-IMT]:</font></font></nobr></div>
<div style="position:absolute;top:3141;left:169"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organizational Unit Name (eg, section) [NETWORK SECURITY]:</font></font></nobr></div>
<div style="position:absolute;top:3159;left:169"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Common Name (eg server FQDN or YOUR name) []: MOOC_CA</font></font></nobr></div>
<div style="position:absolute;top:3177;left:169"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Email Address []: CA@mooc.imt</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:3233;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 Creation of certificates</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:3270;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now that we have the keys and the certificate of our certification authority,</font></font></nobr></div>
<div style="position:absolute;top:3288;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we will be able to issue certificates to the various stakeholders in the company.</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:3328;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creating the server certificate</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:3357;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We will start by creating a certificate for the company's web server: www.mooc.imt.</font></font></nobr></div>
<div style="position:absolute;top:3375;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first step is the generation of a key pair of its own:</font></font></nobr></div>
<div style="position:absolute;top:3409;left:255"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl genrsa -des3 -out server.key.pem 1024</font></font></nobr></div>
<div style="position:absolute;top:3459;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q3: What does the parameter 1024 mean in the previous command?</font></font></nobr></div>
<div style="position:absolute;top:3489;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a) Period of validity of the key pair.</font></font></nobr></div>
<div style="position:absolute;top:3519;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) Number of bits in the key pair.</font></font></nobr></div>
<div style="position:absolute;top:3549;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now that we have this key, we will generate a certification request</font></font></nobr></div>
<div style="position:absolute;top:3567;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Certificate Signing Request - CSR). </font><font style="vertical-align: inherit;">This operation is done by the web server manager,</font></font></nobr></div>
<div style="position:absolute;top:3584;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">just like the previous step, the private key of the server does not need to be known to</font></font></nobr></div>
<div style="position:absolute;top:3602;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the certification operator.</font></font></nobr></div>
<div style="position:absolute;top:3634;left:212"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl req -config openssl.cnf -new -key server.key.pem</font></font></nobr></div>
<div style="position:absolute;top:3651;left:372"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-out server.req.pem</font></font></nobr></div>
<div style="position:absolute;top:3680;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NB: the value of the cn entered when creating the certificate must be the name of the server</font></font></nobr></div>
<div style="position:absolute;top:3698;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for our web browsers to accept secure connections: Common name</font></font></nobr></div>
<div style="position:absolute;top:3716;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(CN) = www.mooc.imt</font></font></nobr></div>
<div style="position:absolute;top:3734;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After sending the certification request to the CA (we just change our hat</font></font></nobr></div>
<div style="position:absolute;top:3752;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">since the CSR is already available on the CA machine), the operator now has no</font></font></nobr></div>
<div style="position:absolute;top:3770;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certification that to validate the content of the certificate, to add the necessary extensions to the</font></font></nobr></div>
<div style="position:absolute;top:3788;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server function (you can consult the configuration file, section server) and to sign</font></font></nobr></div>
<div style="position:absolute;top:3806;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the certificate for the www.mooc.imt server.</font></font></nobr></div>
<div style="position:absolute;top:3869;left:443"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></nobr></div>
</span></font>

<div style="position:absolute;top:3961;left:0"><hr><table border="0" width="100%"><tbody><tr><td bgcolor="eeeeee" align="right"><font face="arial,sans-serif"><a name="4"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page 4</font></font></b></a></font></td></tr></tbody></table></div><font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4094;left:239"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl ca -config openssl.cnf -in server.req.pem</font></font></nobr></div>
<div style="position:absolute;top:4112;left:298"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-out server.crt.pem -extensions server</font></font></nobr></div>
<div style="position:absolute;top:4162;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q4: What are the elements that can be found in the electronic certificate of a machine?</font></font></nobr></div>
<div style="position:absolute;top:4192;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a) The name, URL of the machine.</font></font></nobr></div>
<div style="position:absolute;top:4222;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) The private key of the machine.</font></font></nobr></div>
<div style="position:absolute;top:4252;left:154"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c) The signature of a trusted third party (certification authority).</font></font></nobr></div>
<div style="position:absolute;top:4281;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d) The period of validity of the certificate.</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:4326;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 Secure connection to a web server</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:4364;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To comply with its specifications, company X must secure exchanges with its</font></font></nobr></div>
<div style="position:absolute;top:4381;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">web server (this is an apache web server) using the HTTPS protocol. </font><font style="vertical-align: inherit;">This web server</font></font></nobr></div>
<div style="position:absolute;top:4399;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">must therefore be able to use the certificate we have just created.</font></font></nobr></div>
<div style="position:absolute;top:4417;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To do this, copy the server's certificate and its private key as well as the authority's certificate</font></font></nobr></div>
<div style="position:absolute;top:4435;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certificate that is in the CA machine on the machine hosting the web server </font></font><font style="font-size:8px"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></nobr></div>
<div style="position:absolute;top:4469;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www $ sudo scp authority @ CA: server.key.pem /etc/apache2/certs/server.key.pem</font></font></nobr></div>
<div style="position:absolute;top:4502;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www $ sudo scp authority @ CA: server.crt.pem /etc/apache2/certs/server.crt.pem</font></font></nobr></div>
<div style="position:absolute;top:4535;left:184"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www $ sudo scp authority @ CA: ca.crt.pem /etc/apache2/certs/ca.crt.pem</font></font></nobr></div>
<div style="position:absolute;top:4567;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The web server has been pre-configured </font></font><font style="font-size:8px"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to use the HTTPS protocol and take the private key</font></font></nobr></div>
<div style="position:absolute;top:4585;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and the certificate he needs to prove his identity in the / etc / apache2 / certs / directory.</font></font></nobr></div>
<div style="position:absolute;top:4603;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Check that these two documents are there.</font></font></nobr></div>
<div style="position:absolute;top:4621;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If everything is correct, start the web service on the www machine:</font></font></nobr></div>
<div style="position:absolute;top:4655;left:317"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www $ sudo systemctl start apache2</font></font></nobr></div>
<div style="position:absolute;top:4686;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When prompted by the server, provide the password to unlock the key</font></font></nobr></div>
<div style="position:absolute;top:4704;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">private web server.</font></font></nobr></div>
<div style="position:absolute;top:4722;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To check and test the correct functioning of secure communications, on one of the</font></font></nobr></div>
<div style="position:absolute;top:4740;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">two brest or marseille machines, launch Firefox from the console:</font></font></nobr></div>
<div style="position:absolute;top:4774;left:384"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">brest $ firefox &amp;</font></font></nobr></div>
<div style="position:absolute;top:4806;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and connect in https to the company's web server:</font></font></nobr></div>
<div style="position:absolute;top:4825;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https: //www.mooc.imt/</font></font></nobr></div>
<div style="position:absolute;top:4842;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Normally, if the configuration of your apache server is correct, your web browser</font></font></nobr></div>
<div style="position:absolute;top:4860;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">should display a number of alerts and prevent you from accessing</font></font></nobr></div>
<div style="position:absolute;top:4878;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to the server.</font></font></nobr></div>
<div style="position:absolute;top:4913;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q5: What do these alerts correspond to?</font></font></nobr></div>
<div style="position:absolute;top:4943;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a) The certificate presented by the server is false;</font></font></nobr></div>
<div style="position:absolute;top:4973;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) The certificate is not made for that;</font></font></nobr></div>
<div style="position:absolute;top:5003;left:154"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c) The certificate cannot be verified.</font></font></nobr></div>
</span></font>
<font size="2" face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:5032;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. The CA machine has an ssh server. </font><font style="vertical-align: inherit;">The password of the authority user is authority</font></font></nobr></div>
<div style="position:absolute;top:5047;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. The configuration used can be found in the file /etc/apache2/sites-available/default-ssl.conf</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5131;left:443"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></nobr></div>
</span></font>

<div style="position:absolute;top:5223;left:0"><hr><table border="0" width="100%"><tbody><tr><td bgcolor="eeeeee" align="right"><font face="arial,sans-serif"><a name="5"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page 5</font></font></b></a></font></td></tr></tbody></table></div><font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5355;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In order for trust to be established between the client and the server, the client must have</font></font></nobr></div>
<div style="position:absolute;top:5373;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">copy of the certificate of the certification authority that signed the certificate presented to it by</font></font></nobr></div>
<div style="position:absolute;top:5391;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the server. </font><font style="vertical-align: inherit;">We must therefore make a copy of the CA certificate on the client's machine (here</font></font></nobr></div>
<div style="position:absolute;top:5410;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">brest) and import this certificate into our web browser.</font></font></nobr></div>
<div style="position:absolute;top:5443;left:306"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">brest $ scp authority @ CA: ca.crt.pem.</font></font></nobr></div>
<div style="position:absolute;top:5475;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On Firefox, choose in Menu&gt; Preferences&gt; Privacy &amp; Security&gt; Certificates&gt;</font></font></nobr></div>
<div style="position:absolute;top:5493;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">View certificates&gt; Authorities&gt; Import and select the certificate of the CA you came from</font></font></nobr></div>
<div style="position:absolute;top:5511;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">copy. </font><font style="vertical-align: inherit;">Check that the certificate you are going to import is that of the CA and indicate</font></font></nobr></div>
<div style="position:absolute;top:5528;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on the dialog box presented to you that you trust this CA to verify</font></font></nobr></div>
<div style="position:absolute;top:5546;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the identity of web servers and user mails. </font><font style="vertical-align: inherit;">Validate the import of the certificate and renew</font></font></nobr></div>
<div style="position:absolute;top:5564;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">send your request to the server. </font><font style="vertical-align: inherit;">You can repeat all of these operations on the machine</font></font></nobr></div>
<div style="position:absolute;top:5584;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marseille.</font></font></nobr></div>
<div style="position:absolute;top:5618;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q6: What do you deduce? </font><font style="vertical-align: inherit;">[1 correct answer]</font></font></nobr></div>
<div style="position:absolute;top:5648;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a) I don't know;</font></font></nobr></div>
<div style="position:absolute;top:5678;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) My browser is able to verify the server certificate because it has a root of</font></font></nobr></div>
<div style="position:absolute;top:5696;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certification that allows it;</font></font></nobr></div>
<div style="position:absolute;top:5726;left:154"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c) My browser is able to verify the server certificate because it has the certificate</font></font></nobr></div>
<div style="position:absolute;top:5744;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from the server;</font></font></nobr></div>
<div style="position:absolute;top:5774;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d) My browser has switched to a more tolerant mode and accepts all certificates from</font></font></nobr></div>
<div style="position:absolute;top:5791;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">servers.</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:5836;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4 Certificate authentication</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5874;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Always to meet the specifications of company X, we must provide each</font></font></nobr></div>
<div style="position:absolute;top:5892;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">user a certificate that must allow him to authenticate on the company's web server.</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:5931;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Client certificates</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:5961;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the same way as when creating the certificate for the server (see section 2),</font></font></nobr></div>
<div style="position:absolute;top:5979;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">create a certificate for each of the goodguy and badboy human users (create a key, a</font></font></nobr></div>
<div style="position:absolute;top:5997;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSR correctly entered for the user concerned, then the certificate itself by taking</font></font></nobr></div>
<div style="position:absolute;top:6015;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">take care to position the -extensions client option).</font></font></nobr></div>
<div style="position:absolute;top:6033;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So that the certificates we have just created allow users to authenticate</font></font></nobr></div>
<div style="position:absolute;top:6051;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on the company's web server, the certificate and its associated private key must be available</font></font></nobr></div>
<div style="position:absolute;top:6069;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for their web browser (Firefox).</font></font></nobr></div>
<div style="position:absolute;top:6086;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To import a certificate and its private key into a web browser, it is necessary to</font></font></nobr></div>
<div style="position:absolute;top:6104;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">store these different elements in a secure container: a file in PKCS # 12 format. </font><font style="vertical-align: inherit;">This</font></font></nobr></div>
<div style="position:absolute;top:6122;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">file format is an interchange format standardized by RSA. </font><font style="vertical-align: inherit;">It is used for exchanges of</font></font></nobr></div>
<div style="position:absolute;top:6140;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all the material relating to a certificate (private key, public key, certificate and certification chain).</font></font></nobr></div>
<div style="position:absolute;top:6158;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It simplifies and secures import operations.</font></font></nobr></div>
<div style="position:absolute;top:6176;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The PKCS # 12 file is created with the following command:</font></font></nobr></div>
<div style="position:absolute;top:6210;left:176"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl pkcs12 -export -in goodguy.crt.pem -inkey goodguy.key.pem</font></font></nobr></div>
<div style="position:absolute;top:6228;left:235"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-out goodguy.p12 -name "Good Guy" -certfile ca.crt.pem</font></font></nobr></div>
<div style="position:absolute;top:6259;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• the -export option specifies the type of operation to do: export the material in the format</font></font></nobr></div>
<div style="position:absolute;top:6278;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PKCS # 12;</font></font></nobr></div>
<div style="position:absolute;top:6307;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• the -in option specifies the name of the file containing the certificate (goodguy.crt.pem)</font></font></nobr></div>
<div style="position:absolute;top:6337;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• the -inkey option designates the file containing the associated private key (goodguy.key.pem);</font></font></nobr></div>
<div style="position:absolute;top:6393;left:443"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></nobr></div>
</span></font>

<div style="position:absolute;top:6485;left:0"><hr><table border="0" width="100%"><tbody><tr><td bgcolor="eeeeee" align="right"><font face="arial,sans-serif"><a name="6"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page 6</font></font></b></a></font></td></tr></tbody></table></div><font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6616;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• the -out option specifies the name of the file where the data will be stored in PKCS # 12 format</font></font></nobr></div>
<div style="position:absolute;top:6635;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(goodguy.p12);</font></font></nobr></div>
<div style="position:absolute;top:6664;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• the -name option is a comment presented to the user during import;</font></font></nobr></div>
<div style="position:absolute;top:6694;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• the -certfile option allows you to include additional certificates. </font><font style="vertical-align: inherit;">Here we added</font></font></nobr></div>
<div style="position:absolute;top:6713;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the certificate of the CA that signed the user certificate.</font></font></nobr></div>
<div style="position:absolute;top:6746;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repeat the operation for the badboy user then transfer the .p12 files to the machines</font></font></nobr></div>
<div style="position:absolute;top:6764;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">user: badboy.p12 on the marseille machine and goodguy.p12 on the brest machine. </font><font style="vertical-align: inherit;">The</font></font></nobr></div>
<div style="position:absolute;top:6782;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contents of PKCS # 12 files can be viewed with the following command:</font></font></nobr></div>
<div style="position:absolute;top:6816;left:302"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">brest $ openssl pkcs12 -in goodguy.p12</font></font></nobr></div>
<div style="position:absolute;top:6865;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q7: Is the private key in the clear?</font></font></nobr></div>
<div style="position:absolute;top:6895;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yes indeed</font></font></nobr></div>
<div style="position:absolute;top:6925;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) No</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:6965;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connection to web server</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:6994;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are now going to modify the configuration of the apache server so that it is</font></font></nobr></div>
<div style="position:absolute;top:7012;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">able to authenticate any user who presents himself with a certificate from our CA.</font></font></nobr></div>
<div style="position:absolute;top:7030;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edit the /etc/apache2/sites-enabled/default-ssl.conf configuration file. </font><font style="vertical-align: inherit;">You</font></font></nobr></div>
<div style="position:absolute;top:7048;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">must uncomment the lines labeled "# 1 -&gt;", that is, remove the "# 1 -&gt;" and do not</font></font></nobr></div>
<div style="position:absolute;top:7066;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no left margin for this uncommented line. </font><font style="vertical-align: inherit;">This operation modifies the pro-</font></font></nobr></div>
<div style="position:absolute;top:7084;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">properties of your web server as follows:</font></font></nobr></div>
<div style="position:absolute;top:7113;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• the SSLVerifyClient directive requires the client to provide a certificate and the SSL- directive</font></font></nobr></div>
<div style="position:absolute;top:7133;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VerifyDepth requires it to be validable;</font></font></nobr></div>
<div style="position:absolute;top:7161;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• the SSLCertificateChainFile and SSLCACertificateFile directives specify which are</font></font></nobr></div>
<div style="position:absolute;top:7180;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the certificates of the CAs that should be used for the validation of client certificates;</font></font></nobr></div>
<div style="position:absolute;top:7209;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• SSLUserName is used to extract an identity from one of the fields of the presented certificate, this</font></font></nobr></div>
<div style="position:absolute;top:7227;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">information is logged and can be used for example when using groups;</font></font></nobr></div>
<div style="position:absolute;top:7257;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• the Require directive applied to the &lt;directory /&gt; object controls access to documents</font></font></nobr></div>
<div style="position:absolute;top:7275;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">available on the server. </font><font style="vertical-align: inherit;">In our case, access is authorized if and only if the field</font></font></nobr></div>
<div style="position:absolute;top:7293;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organization (O) of the subject of the certificate presented has the value AA MOOC IMT.</font></font></nobr></div>
<div style="position:absolute;top:7323;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Once the configuration file has been modified, you can restart the apache server:</font></font></nobr></div>
<div style="position:absolute;top:7357;left:309"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www $ sudo systemctl restart apache2</font></font></nobr></div>
<div style="position:absolute;top:7389;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can observe the operation of the web server by consulting the log files that are</font></font></nobr></div>
<div style="position:absolute;top:7407;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">found in the / var / log / apache directory. </font><font style="vertical-align: inherit;">The use of the tail command and its option</font></font></nobr></div>
<div style="position:absolute;top:7426;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-f allows to see in real time the requests made to the server.</font></font></nobr></div>
<div style="position:absolute;top:7459;left:278"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www $ tail -f /var/log/apache/ssl_access.log</font></font></nobr></div>
<div style="position:absolute;top:7490;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the Brest, then Marseille machines, use Firefox again to connect to the</font></font></nobr></div>
<div style="position:absolute;top:7508;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Web server.</font></font></nobr></div>
<div style="position:absolute;top:7544;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q8: What do you see?</font></font></nobr></div>
<div style="position:absolute;top:7574;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a) I cannot connect;</font></font></nobr></div>
<div style="position:absolute;top:7604;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) I can connect;</font></font></nobr></div>
<div style="position:absolute;top:7655;left:443"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></nobr></div>
</span></font>

<div style="position:absolute;top:7747;left:0"><hr><table border="0" width="100%"><tbody><tr><td bgcolor="eeeeee" align="right"><font face="arial,sans-serif"><a name="7"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page 7</font></font></b></a></font></td></tr></tbody></table></div><font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:7879;left:154"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c) I don't know how to specify my identity.</font></font></nobr></div>
<div style="position:absolute;top:7908;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On each of the brest and marseille machines, import the .p12 file into your browser</font></font></nobr></div>
<div style="position:absolute;top:7926;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">web. </font><font style="vertical-align: inherit;">Check the validity of your user certificate (information that can be consulted in</font></font></nobr></div>
<div style="position:absolute;top:7944;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">double-clicking on the certificate). </font><font style="vertical-align: inherit;">If your certificate is not valid, you have without</font></font></nobr></div>
<div style="position:absolute;top:7961;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doubt forgot to indicate that the CA certificate could be used to validate certificates</font></font></nobr></div>
<div style="position:absolute;top:7979;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">servers and user certificates (emails).</font></font></nobr></div>
<div style="position:absolute;top:7997;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Since then, successively Brest then Marseille, consult again the url https: //www.mooc.imt/</font></font></nobr></div>
<div style="position:absolute;top:8033;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q9: What do you see?</font></font></nobr></div>
<div style="position:absolute;top:8062;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a) I cannot connect;</font></font></nobr></div>
<div style="position:absolute;top:8091;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) I can connect;</font></font></nobr></div>
<div style="position:absolute;top:8120;left:154"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c) I don't know how to specify my identity.</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:19px;font-family:Times">
<div style="position:absolute;top:8165;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5 Certificate validity management</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8202;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When the certification authority issues a certificate, it associates a period of validity:</font></font></nobr></div>
<div style="position:absolute;top:8220;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">its creation date and its expiry date. </font><font style="vertical-align: inherit;">This certificate will therefore be considered valid.</font></font></nobr></div>
<div style="position:absolute;top:8238;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">throughout this period. </font><font style="vertical-align: inherit;">But the situation of the certificate owner may change. </font><font style="vertical-align: inherit;">Through</font></font></nobr></div>
<div style="position:absolute;top:8256;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, if it is a person, they may have left the company, changed their assignment and some</font></font></nobr></div>
<div style="position:absolute;top:8274;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">actions which were authorized for it no longer have any reason to exist, the private key of the certificate has</font></font></nobr></div>
<div style="position:absolute;top:8292;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">could be compromised ... It is therefore necessary to have a means to invalidate a certificate,</font></font></nobr></div>
<div style="position:absolute;top:8310;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">regardless of the information contained in the certificate itself.</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:8349;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1 List of revoked certificates (CRL)</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:8379;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first method that was chosen is the so-called revocation lists (Certificate</font></font></nobr></div>
<div style="position:absolute;top:8397;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Revocation List - CRL in English). </font><font style="vertical-align: inherit;">The operation is as follows: when a request for</font></font></nobr></div>
<div style="position:absolute;top:8414;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revocation, the serial number of the certificate concerned is added to the list of certificates already</font></font></nobr></div>
<div style="position:absolute;top:8432;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revoked and this list is signed by the PKI manager so that the users</font></font></nobr></div>
<div style="position:absolute;top:8450;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can be trusted (revoking a certificate is an operation that must be done with as much</font></font></nobr></div>
<div style="position:absolute;top:8468;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">serious than signing a certificate).</font></font></nobr></div>
<div style="position:absolute;top:8486;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">With openssl, there are two steps to revoking a certificate:</font></font></nobr></div>
<div style="position:absolute;top:8515;left:154"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. revocation of the certificate itself. </font><font style="vertical-align: inherit;">The fact that the certificate is revoked is logged</font></font></nobr></div>
<div style="position:absolute;top:8533;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the index.txt file of your CA. </font><font style="vertical-align: inherit;">For the certificate concerned, there is the date of</font></font></nobr></div>
<div style="position:absolute;top:8551;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revocation and the reason for such revocation.</font></font></nobr></div>
<div style="position:absolute;top:8580;left:154"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Generation of the list of revocations. </font><font style="vertical-align: inherit;">openssl uses all the information</font></font></nobr></div>
<div style="position:absolute;top:8598;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">available in the index.txt file to establish the revocation list. </font><font style="vertical-align: inherit;">This listing is</font></font></nobr></div>
<div style="position:absolute;top:8616;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">then signed by the CA.</font></font></nobr></div>
<div style="position:absolute;top:8644;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are now going to revoke the certificate of the badboy user and then generate a list</font></font></nobr></div>
<div style="position:absolute;top:8662;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revocations. </font><font style="vertical-align: inherit;">These operations are performed on the CA machine.</font></font></nobr></div>
<div style="position:absolute;top:8701;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Revocation of a certificate</font></font></nobr></div>
<div style="position:absolute;top:8729;left:223"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl ca -config openssl.cnf -revoke badboy.crt.pem</font></font></nobr></div>
<div style="position:absolute;top:8747;left:349"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-crl_reason keyCompromise</font></font></nobr></div>
<div style="position:absolute;top:8785;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Generating the revocation list</font></font></nobr></div>
<div style="position:absolute;top:8813;left:231"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl ca -config openssl.cnf -gencrl -out crl.pem</font></font></nobr></div>
<div style="position:absolute;top:8843;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can view the contents of this revocation list with the following command:</font></font></nobr></div>
<div style="position:absolute;top:8873;left:317"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl crl -text -in crl.pem</font></font></nobr></div>
<div style="position:absolute;top:8917;left:443"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></nobr></div>
</span></font>

<div style="position:absolute;top:9009;left:0"><hr><table border="0" width="100%"><tbody><tr><td bgcolor="eeeeee" align="right"><font face="arial,sans-serif"><a name="8"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page 8</font></font></b></a></font></td></tr></tbody></table></div><font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9159;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q10: What is a revoked certificate used for?</font></font></nobr></div>
<div style="position:absolute;top:9189;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a) To encrypt messages.</font></font></nobr></div>
<div style="position:absolute;top:9219;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) To verify signatures.</font></font></nobr></div>
<div style="position:absolute;top:9249;left:154"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c) Neither to encrypt messages, nor to verify signatures.</font></font></nobr></div>
<div style="position:absolute;top:9279;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the Marseille machine, connect with Firefox to the web server.</font></font></nobr></div>
<div style="position:absolute;top:9314;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q11: What do you see?</font></font></nobr></div>
<div style="position:absolute;top:9344;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a) ¸It hasn't changed anything;</font></font></nobr></div>
<div style="position:absolute;top:9374;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) The badboy user can no longer connect;</font></font></nobr></div>
<div style="position:absolute;top:9404;left:154"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c) Revoking a certificate is not immediately taken into account.</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:9444;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.2 Web server and revocation list</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:9474;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In order for our web server to take the revocation information into account, we must</font></font></nobr></div>
<div style="position:absolute;top:9491;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">copy the revocation list there and modify the configuration file of the apache server to</font></font></nobr></div>
<div style="position:absolute;top:9509;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that it is taken into account.</font></font></nobr></div>
<div style="position:absolute;top:9527;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edit the /etc/apache2/sites-enabled/default-ssl.conf configuration file. </font><font style="vertical-align: inherit;">You</font></font></nobr></div>
<div style="position:absolute;top:9545;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">must uncomment the lines labeled "# 2 -&gt;". </font><font style="vertical-align: inherit;">This operation modifies the properties of</font></font></nobr></div>
<div style="position:absolute;top:9563;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">your web server as follows:</font></font></nobr></div>
<div style="position:absolute;top:9592;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• the SSLCARevocationFile directive designates the list of revocations to be taken into account</font></font></nobr></div>
<div style="position:absolute;top:9611;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(check that you have copied the crl.pem file to the location indicated);</font></font></nobr></div>
<div style="position:absolute;top:9640;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• the SSLCARevocationCheck directive specifies the verification mode that the server must</font></font></nobr></div>
<div style="position:absolute;top:9659;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enforce. </font><font style="vertical-align: inherit;">Here, it is the chain mode which indicates that for each certificate</font></font></nobr></div>
<div style="position:absolute;top:9677;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">presented, the entire certification chain must be verified.</font></font></nobr></div>
<div style="position:absolute;top:9707;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restart the apache server:</font></font></nobr></div>
<div style="position:absolute;top:9738;left:309"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www $ sudo systemctl restart apache2</font></font></nobr></div>
<div style="position:absolute;top:9766;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the Marseille machine, then on the Brest machine, connect with Firefox to the server</font></font></nobr></div>
<div style="position:absolute;top:9784;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">web (firefox managing a cache of pages already read, force the reload using the button provided for this</font></font></nobr></div>
<div style="position:absolute;top:9802;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">effect).</font></font></nobr></div>
<div style="position:absolute;top:9838;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q12: What do you see?</font></font></nobr></div>
<div style="position:absolute;top:9868;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a) ¸It hasn't changed anything;</font></font></nobr></div>
<div style="position:absolute;top:9898;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) The badboy user can no longer connect;</font></font></nobr></div>
<div style="position:absolute;top:9928;left:154"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c) The badboy user can still connect;</font></font></nobr></div>
<div style="position:absolute;top:9958;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d) The goodguy user can no longer connect;</font></font></nobr></div>
<div style="position:absolute;top:9988;left:154"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e) The goodguy user can still connect;</font></font></nobr></div>
<div style="position:absolute;top:10017;left:154"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f) It is necessary to have a copy of the list of revocations.</font></font></nobr></div>
<div style="position:absolute;top:10179;left:443"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></nobr></div>
</span></font>

<div style="position:absolute;top:10271;left:0"><hr><table border="0" width="100%"><tbody><tr><td bgcolor="eeeeee" align="right"><font face="arial,sans-serif"><a name="9"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page 9</font></font></b></a></font></td></tr></tbody></table></div><font size="3" face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:10401;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.3 OCSP (This section is optional)</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:10431;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We have just seen that for the revocation of a certificate to be taken into account, a</font></font></nobr></div>
<div style="position:absolute;top:10449;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a number of operations are necessary:</font></font></nobr></div>
<div style="position:absolute;top:10478;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• the CA should be questioned regularly to find out if there are any updates to the revocation list.</font></font></nobr></div>
<div style="position:absolute;top:10496;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tions were made;</font></font></nobr></div>
<div style="position:absolute;top:10526;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• make a copy of the revocation list on its web server;</font></font></nobr></div>
<div style="position:absolute;top:10555;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• restart the web server for the new list to be taken into account.</font></font></nobr></div>
<div style="position:absolute;top:10586;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">All these operations lead to delays between the moment when the certificate is revoked and the</font></font></nobr></div>
<div style="position:absolute;top:10604;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">when our web server can take this into account, which can pose security problems</font></font></nobr></div>
<div style="position:absolute;top:10622;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in certain situations.</font></font></nobr></div>
<div style="position:absolute;top:10640;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is to answer this problem that the OCSP protocol (Online Certifcate Status Protocol)</font></font></nobr></div>
<div style="position:absolute;top:10658;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">has been proposed. </font><font style="vertical-align: inherit;">The idea is as follows: any certification authority can implement a</font></font></nobr></div>
<div style="position:absolute;top:10676;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">online validation service for the certificates it has signed. </font><font style="vertical-align: inherit;">In each of the certificates is</font></font></nobr></div>
<div style="position:absolute;top:10694;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">specified the URL of this validation service. </font><font style="vertical-align: inherit;">Simply query this service to check the validity</font></font></nobr></div>
<div style="position:absolute;top:10712;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of the certificate that is presented. </font><font style="vertical-align: inherit;">To ensure the validity of this verification, the information</font></font></nobr></div>
<div style="position:absolute;top:10730;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exchanged are signed by the certification authority itself or by an authorized certificate (signed</font></font></nobr></div>
<div style="position:absolute;top:10748;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">by this CA and having the OCSPSigning usage extension).</font></font></nobr></div>
<div style="position:absolute;top:10765;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you study the information contained in the certificates, you will see that they</font></font></nobr></div>
<div style="position:absolute;top:10783;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">have the authorityInfoAccess attribute which has the value OCSP; URI: http: //ocsp.mooc.imt: 8888.</font></font></nobr></div>
<div style="position:absolute;top:10801;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This attribute simply indicates how and where to contact the OCSP server managed by our CA.</font></font></nobr></div>
<div style="position:absolute;top:10819;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To implement an OCSP service, the first thing to do is to create a certificate for it.</font></font></nobr></div>
<div style="position:absolute;top:10837;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This certificate will allow him to indicate to users that he is legitimate to sign responses.</font></font></nobr></div>
<div style="position:absolute;top:10855;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OCSP for our CA (extendedKeyUsage = OCSPSigning). </font><font style="vertical-align: inherit;">As with our web server, the</font></font></nobr></div>
<div style="position:absolute;top:10873;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">creating the certificate for the OCSP server is done in 3 steps:</font></font></nobr></div>
<div style="position:absolute;top:10902;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• creation of an RSA key,</font></font></nobr></div>
<div style="position:absolute;top:10932;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• generation of the Certificate Signing Request, specifying that the CN field is</font></font></nobr></div>
<div style="position:absolute;top:10951;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ocsp.mooc.imt value </font></font><font style="font-size:8px"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></nobr></div>
<div style="position:absolute;top:10980;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• and finally generation and signature of a certificate with the correct extensions (-extensions</font></font></nobr></div>
<div style="position:absolute;top:11000;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ocsp_ext).</font></font></nobr></div>
<div style="position:absolute;top:11033;left:262"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl genrsa -des3 -out ocsp.key.pem 1024</font></font></nobr></div>
<div style="position:absolute;top:11066;left:219"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl req -config openssl.cnf -new -key ocsp.key.pem</font></font></nobr></div>
<div style="position:absolute;top:11084;left:380"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-out ocsp.req.pem</font></font></nobr></div>
<div style="position:absolute;top:11116;left:247"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl ca -config openssl.cnf -in ocsp.req.pem</font></font></nobr></div>
<div style="position:absolute;top:11134;left:298"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-out ocsp.crt.pem -extensions ocsp_ext</font></font></nobr></div>
<div style="position:absolute;top:11166;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are now going to launch an OCSP server on the machine that hosts your CA.</font></font></nobr></div>
<div style="position:absolute;top:11184;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To go back, we are going to pretend that the badboy certificate had not been</font></font></nobr></div>
<div style="position:absolute;top:11202;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revoked by modifying the index.txt file:</font></font></nobr></div>
<div style="position:absolute;top:11231;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• on the line concerning badboy, we will replace the R at the beginning of the line by V</font></font></nobr></div>
<div style="position:absolute;top:11250;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(R = Revoked, V = Valid);</font></font></nobr></div>
<div style="position:absolute;top:11279;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• then delete the 3rd field (this is the date and reason for the revocation);</font></font></nobr></div>
<div style="position:absolute;top:11309;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• finally, save the file.</font></font></nobr></div>
</span></font>
<font size="2" face="Times"><span style="font-size:9px;font-family:Times">
<div style="position:absolute;top:11338;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. For the DNS server we are using, the ocsp.mooc.imt machine has been defined as an alias (a</font></font></nobr></div>
<div style="position:absolute;top:11352;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">other name) of the ca.mooc.imt machine</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11441;left:443"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></nobr></div>
</span></font>

<div style="position:absolute;top:11533;left:0"><hr><table border="0" width="100%"><tbody><tr><td bgcolor="eeeeee" align="right"><font face="arial,sans-serif"><a name="10"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page 10</font></font></b></a></font></td></tr></tbody></table></div><font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:11665;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We need to configure your apache server so that it now uses OCSP</font></font></nobr></div>
<div style="position:absolute;top:11683;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to check the validity of customer certificates. </font><font style="vertical-align: inherit;">To do this we must comment on both</font></font></nobr></div>
<div style="position:absolute;top:11701;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines concerning the use of revocation lists (they are labeled "# &lt;- 2") and</font></font></nobr></div>
<div style="position:absolute;top:11719;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uncomment the line about OCSP (labeled "# 3 -&gt;").</font></font></nobr></div>
<div style="position:absolute;top:11737;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The openssl ocsp command is used to test the operation of this protocol. </font><font style="vertical-align: inherit;">Launch</font></font></nobr></div>
<div style="position:absolute;top:11755;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the OCSP server on the CA machine.</font></font></nobr></div>
<div style="position:absolute;top:11789;left:215"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ca $ openssl ocsp -port 8888 -index index.txt -CA ca.crt.pem</font></font></nobr></div>
<div style="position:absolute;top:11807;left:251"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-rsigner ocsp.crt.pem -rkey ocsp.key.pem -req_text</font></font></nobr></div>
<div style="position:absolute;top:11838;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restart the web server so that the new configuration is taken into account:</font></font></nobr></div>
<div style="position:absolute;top:11873;left:309"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www $ sudo systemctl restart apache2</font></font></nobr></div>
<div style="position:absolute;top:11904;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connect to the web server with Firefox and verify that goodguy and badboy have access</font></font></nobr></div>
<div style="position:absolute;top:11922;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">both to the server.</font></font></nobr></div>
<div style="position:absolute;top:11940;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Revoke the badboy certificate on the CA and restart the OCSP server.</font></font></nobr></div>
<div style="position:absolute;top:11974;left:223"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl ca -config openssl.cnf -revoke badboy.crt.pem</font></font></nobr></div>
<div style="position:absolute;top:11992;left:349"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-crl_reason keyCompromise</font></font></nobr></div>
<div style="position:absolute;top:12024;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reconnect to the web server from the brest machine with the goodguy identity, then</font></font></nobr></div>
<div style="position:absolute;top:12042;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from the Marseille machine with the badboy identity.</font></font></nobr></div>
<div style="position:absolute;top:12078;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q13: What do you see?</font></font></nobr></div>
<div style="position:absolute;top:12113;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the CA, make a copy of the index.txt file, then revoke the web server certificate,</font></font></nobr></div>
<div style="position:absolute;top:12131;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">then restart the OCSP server.</font></font></nobr></div>
<div style="position:absolute;top:12166;left:223"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CA $ openssl ca -config openssl.cnf -revoke server.crt.pem</font></font></nobr></div>
<div style="position:absolute;top:12183;left:349"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-crl_reason keyCompromise</font></font></nobr></div>
<div style="position:absolute;top:12215;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">From the brest machine, reconnect to the web server.</font></font></nobr></div>
<div style="position:absolute;top:12251;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q14: What do you see?</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:15px;font-family:Times">
<div style="position:absolute;top:12291;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.4 OCSP Stapling</font></font></nobr></div>
</span></font>
<font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12320;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the scale of the Internet, the implementation of the OCSP protocol generates a very large number of</font></font></nobr></div>
<div style="position:absolute;top:12338;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of queries. </font><font style="vertical-align: inherit;">Potentially, every time a client connects to a server, it may want to</font></font></nobr></div>
<div style="position:absolute;top:12356;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">check the validity of the certificate presented to him. </font><font style="vertical-align: inherit;">To limit this additional cost, web browsers</font></font></nobr></div>
<div style="position:absolute;top:12374;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cache OCSP responses and until this data is invalidated, it is</font></font></nobr></div>
<div style="position:absolute;top:12392;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not informed of revoked certificates. </font><font style="vertical-align: inherit;">In addition, checking the validity of certificates takes</font></font></nobr></div>
<div style="position:absolute;top:12410;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">time to the customer and is considered detrimental to the user experience. </font><font style="vertical-align: inherit;">To try to</font></font></nobr></div>
<div style="position:absolute;top:12428;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to solve these problems, a new method has been proposed: OCSP stapling (OCSP-stapling).</font></font></nobr></div>
<div style="position:absolute;top:12446;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The idea is as follows: at regular intervals, the server asks the OCSP server of its CA to</font></font></nobr></div>
<div style="position:absolute;top:12464;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">provide him with confirmation of the validity of his own certificate. </font><font style="vertical-align: inherit;">He can then transmit it with</font></font></nobr></div>
<div style="position:absolute;top:12482;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">its certificate during the negotiation phase of the TLS connection. </font><font style="vertical-align: inherit;">In this way, the cost for</font></font></nobr></div>
<div style="position:absolute;top:12500;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obtaining the validation of the certificate is no longer the responsibility of the client (but of the server), and the number</font></font></nobr></div>
<div style="position:absolute;top:12518;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of OCSP validation requests is very much reduced (only the servers make requests</font></font></nobr></div>
<div style="position:absolute;top:12536;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for their own certificate and at a fairly low frequency, for example every hour). </font><font style="vertical-align: inherit;">Yes</font></font></nobr></div>
<div style="position:absolute;top:12553;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this new method limits the traffic to the OCSP servers, it does not allow to obtain in</font></font></nobr></div>
<div style="position:absolute;top:12571;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real-time certificate validity information. </font><font style="vertical-align: inherit;">Indeed, the OCSP response is dated by the</font></font></nobr></div>
<div style="position:absolute;top:12589;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server then stapled to the certificate for a while, during which time it may have been</font></font></nobr></div>
<div style="position:absolute;top:12607;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revoked.</font></font></nobr></div>
<div style="position:absolute;top:12625;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The OCSP Stapling implementation is very simple in apache. </font><font style="vertical-align: inherit;">It consists in activating the</font></font></nobr></div>
<div style="position:absolute;top:12643;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSLUseStapling directive (labeled "# &lt;- 4") in the configuration file and to adjust, if</font></font></nobr></div>
<div style="position:absolute;top:12703;left:439"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></nobr></div>
</span></font>

<div style="position:absolute;top:12795;left:0"><hr><table border="0" width="100%"><tbody><tr><td bgcolor="eeeeee" align="right"><font face="arial,sans-serif"><a name="11"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page 11</font></font></b></a></font></td></tr></tbody></table></div><font size="3" face="Times"><span style="font-size:12px;font-family:Times">
<div style="position:absolute;top:12927;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this is necessary the directives concerning the management of the cache (directives SSLStaplingStan-</font></font></nobr></div>
<div style="position:absolute;top:12946;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dardCacheTimeout and SSLStaplingErrorCacheTimeout). </font><font style="vertical-align: inherit;">Once the changes are made and</font></font></nobr></div>
<div style="position:absolute;top:12963;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saved, all you have to do is restart the web server which will connect to the OCSP server of your CA</font></font></nobr></div>
<div style="position:absolute;top:12981;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">during the first connection.</font></font></nobr></div>
<div style="position:absolute;top:12999;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can verify that OCSP stapling is working by issuing the following command on</font></font></nobr></div>
<div style="position:absolute;top:13018;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">brest:</font></font></nobr></div>
<div style="position:absolute;top:13051;left:149"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">brest $ openssl s_client -connect www.mooc.imt: 443 -CAfile ca.crt.pem -status</font></font></nobr></div>
<div style="position:absolute;top:13083;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the information related to connection negotiation, you will find a copy of the</font></font></nobr></div>
<div style="position:absolute;top:13100;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OCSP response made to the server and the status of this response.</font></font></nobr></div>
<div style="position:absolute;top:13118;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are now going to carry out some tests:</font></font></nobr></div>
<div style="position:absolute;top:13136;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to do this, restore the index.txt file saved previously (where the servers and</font></font></nobr></div>
<div style="position:absolute;top:13154;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clients all have valid certificates). </font><font style="vertical-align: inherit;">Restart the OCSP server, the web server and firefox</font></font></nobr></div>
<div style="position:absolute;top:13172;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in brest or marseille. </font><font style="vertical-align: inherit;">If everything is configured correctly, you will access without error</font></font></nobr></div>
<div style="position:absolute;top:13190;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.mooc.imt /.</font></font></nobr></div>
<div style="position:absolute;top:13208;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now stop the OCSP server on ca.mooc.imt, then restart firefox on brest or</font></font></nobr></div>
<div style="position:absolute;top:13227;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marseille.</font></font></nobr></div>
<div style="position:absolute;top:13262;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q15: Firefox tells us that the connection is secure</font></font></nobr></div>
<div style="position:absolute;top:13292;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a) because the server certificate has not been revoked;</font></font></nobr></div>
<div style="position:absolute;top:13322;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) the OCSP response is valid and is still transmitted by the server.</font></font></nobr></div>
<div style="position:absolute;top:13352;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relaunch firefox and repeat the previous tests after a few minutes (wait at</font></font></nobr></div>
<div style="position:absolute;top:13369;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">less 3 minutes)</font></font></nobr></div>
<div style="position:absolute;top:13405;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q16: Firefox tells us that the connection is not secure</font></font></nobr></div>
<div style="position:absolute;top:13435;left:153"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a) it could not validate the certificate with the OCSP server;</font></font></nobr></div>
<div style="position:absolute;top:13465;left:152"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) the certificate presented by the web server does not contain OCSP stapling;</font></font></nobr></div>
<div style="position:absolute;top:13495;left:154"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c) the certificate presented by the web server does not contain OCSP stapling and firefox does not have</font></font></nobr></div>
<div style="position:absolute;top:13513;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">was able to validate the certificate with the OCSP server.</font></font></nobr></div>
<div style="position:absolute;top:13543;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Revoke the web server certificate and then restart the OCSP server.</font></font></nobr></div>
<div style="position:absolute;top:13561;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can force the systematic use of OCSP in Firefox by accessing the configu-</font></font></nobr></div>
<div style="position:absolute;top:13579;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ration (about: config) and enabling the following directive:</font></font></nobr></div>
<div style="position:absolute;top:13608;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• security.OCSP.require: the security.OCSP.require to false (the default) means that the</font></font></nobr></div>
<div style="position:absolute;top:13627;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OCSP it is not forced. </font><font style="vertical-align: inherit;">Check the security.OCSP.enabled it is 1 (active, enabled) (0,</font></font></nobr></div>
<div style="position:absolute;top:13644;left:173"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zero, is disabled).</font></font></nobr></div>
<div style="position:absolute;top:13674;left:158"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anyway, the caches, whether in firefox or with the web server, seem</font></font></nobr></div>
<div style="position:absolute;top:13692;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">behave in a rather bizarre manner ... To properly observe the behaviors</font></font></nobr></div>
<div style="position:absolute;top:13710;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sought, the easiest way is to stop the services and programs and then restart them by</font></font></nobr></div>
<div style="position:absolute;top:13728;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">depending on what we expect to observe.</font></font></nobr></div>
<div style="position:absolute;top:13764;left:136"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q17: Last question: what interest do you see in the use of the OCSP protocol?</font></font></nobr></div>
<div style="position:absolute;top:13965;left:439"><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11</font></font></nobr></div>
</span></font>


<script>_addload(function(){_setupIW('com');_csi('fr','en','certificate-exportVM.pdf');});</script>
            <script>
              function gtElInit() {
                var lib = new google.translate.TranslateService();
                lib.setCheckVisibility(false);
                lib.translatePage('fr', 'en', function (progress, done, error) {
                  if (progress == 100 || done || error) {
                    document.getElementById("gt-dt-spinner").style.display = "none";
                  }
                });
              }
            </script>
            <script src="./´ TP Statement Electronic Certificates ∗ †_files/f.txt">
            </script><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./´ TP Statement Electronic Certificates ∗ †_files/translate_24dp.png" width="20" height="20" alt="Google Translate"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">Original text</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">Contribute a better translation</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>
          <div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div><span><div class="gmnoprint" style="display: none; z-index: 2147483647;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iws_n.png" style="position: absolute; left: 0px; top: 0px; width: 628px; height: 8px; border: 0px; padding: 0px; margin: 0px;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iws_n.png" style="position: absolute; left: 0px; top: 0px; width: 628px; height: 8px; border: 0px; padding: 0px; margin: 0px;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iws_w.png" style="position: absolute; left: 0px; top: 0px; width: 8px; height: 598px; border: 0px; padding: 0px; margin: 0px;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iws_e.png" style="position: absolute; left: 0px; top: 0px; width: 8px; height: 598px; border: 0px; padding: 0px; margin: 0px;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iws_s.png" style="position: absolute; left: 0px; top: 0px; width: 628px; height: 8px; border: 0px; padding: 0px; margin: 0px;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iws_s.png" style="position: absolute; left: 0px; top: 0px; width: 628px; height: 8px; border: 0px; padding: 0px; margin: 0px;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iws_c.png" style="position: absolute; left: 0px; top: 0px; width: 628px; height: 598px; border: 0px; padding: 0px; margin: 0px;"><div class="SPRITE_iws_nw" style="overflow: hidden;"></div><div class="SPRITE_iws_ne" style="overflow: hidden;"></div><div class="SPRITE_iws_sw" style="overflow: hidden;"></div><div class="SPRITE_iws_se" style="overflow: hidden;"></div><div class="SPRITE_iws_tap" style="overflow: hidden;"></div><div class="SPRITE_iws_tap_l" style="overflow: hidden;"></div><div class="SPRITE_iws_tap_u" style="overflow: hidden;"></div><div class="SPRITE_iws_tap_ul" style="overflow: hidden;"></div><div class="SPRITE_iws_tap_rd" style="overflow: hidden;"></div><div class="SPRITE_iws_tap_ld" style="overflow: hidden;"></div><div class="SPRITE_iws_tab_dl" style="overflow: hidden; display: none;"></div><div class="SPRITE_iws_tab_dr" style="overflow: hidden; display: none;"></div><div class="SPRITE_iws_tab_l" style="overflow: hidden; display: none;"></div><div class="SPRITE_iws_tab_r" style="overflow: hidden; display: none;"></div></div></span><div id="google-infowindow" class="notranslate"><div class="gmnoprint" style="display: none; z-index: 2147483647;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iw_n.png" style="position: absolute; left: 0px; top: 0px; width: 628px; height: 6px; border: 0px; padding: 0px; margin: 0px;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iw_n.png" style="position: absolute; left: 0px; top: 0px; width: 628px; height: 6px; border: 0px; padding: 0px; margin: 0px;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iw_w.png" style="position: absolute; left: 0px; top: 0px; width: 6px; height: 598px; border: 0px; padding: 0px; margin: 0px;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iw_e.png" style="position: absolute; left: 0px; top: 0px; width: 6px; height: 598px; border: 0px; padding: 0px; margin: 0px;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iw_s0.png" style="position: absolute; left: 0px; top: 0px; width: 628px; height: 6px; border: 0px; padding: 0px; margin: 0px;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iw_s0.png" style="position: absolute; left: 0px; top: 0px; width: 628px; height: 6px; border: 0px; padding: 0px; margin: 0px;"><img src="./´ TP Statement Electronic Certificates ∗ †_files/iw_c.png" style="position: absolute; left: 0px; top: 0px; width: 628px; height: 598px; border: 0px; padding: 0px; margin: 0px;"><div class="SPRITE_iw_nw" style="overflow: hidden;"></div><div class="SPRITE_iw_ne" style="overflow: hidden;"></div><div class="SPRITE_iw_xtap" style="overflow: hidden;"></div><div class="SPRITE_iw_xtap_l" style="overflow: hidden;"></div><div class="SPRITE_iw_xtap_u" style="overflow: hidden;"></div><div class="SPRITE_iw_xtap_ul" style="overflow: hidden;"></div><div class="SPRITE_iw_xtap_rd" style="overflow: hidden;"></div><div class="SPRITE_iw_xtap_ld" style="overflow: hidden;"></div><div class="SPRITE_iw_sw0" style="overflow: hidden;"></div><div class="SPRITE_iw_se0" style="overflow: hidden;"></div><div class="SPRITE_close" style="overflow: hidden; z-index: 10000; cursor: pointer; visibility: visible;"></div><div class="SPRITE_maximize" style="overflow: hidden; z-index: 10000; visibility: hidden; cursor: pointer; display: none;"></div><div class="SPRITE_restore" style="overflow: hidden; z-index: 10001; visibility: hidden; cursor: pointer; display: none;"></div></div></div><div style="display: none;"><iframe sandbox="" id="google-feedback-frame" name="FEEDBACK_TARGET_IFRAME_NAME" src="./´ TP Statement Electronic Certificates ∗ †_files/saved_resource.html"></iframe></div></body></html>